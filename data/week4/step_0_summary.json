{
  "step": 0,
  "valid_samples": 9,
  "total_samples": 32,
  "best_score": 2.5431293411128557,
  "code_sample": "def run_packing():\n    rng = np.random.default_rng(12345)\n    best_sum = -1.0\n    best_centers = None\n    best_radii = None\n    # initial candidates\n    # try a few initial patterns:\n    init_patterns = []\n    # 1) 5x5 grid + extra point at center\n    grid = []\n    for i in range(5):\n        for j in range(5):\n            grid.append([0.1+0.2*i, 0.1+0.2*j])\n    grid = np.array(grid)\n    # add a 26th random point near (0.5,0.5)\n    extra = np.array([0.5,0.5])\n    init_patterns.append(np.vstack([grid, extra]))\n    # 2) hex lattice s=0.18 with many points, then select 26 by random subset\n    s = 0.18\n    pts_full = hex_grid_points(s, 0.0, 0.0) # defined earlier maybe copy\n    # keep those inside square with side margin r=s/2\n    mask = (pts_full[:,0] >= s/2) & (pts_full[:,0] = s/2) & (pts_full[:,1]  best_sum:\n            best_sum = tot\n            best_centers = cent.copy()\n            best_radii = rad.copy()\n    # now hill climb\n    sigma = 0.05  # initial perturbation magnitude\n    for iter in range(20000):\n        # propose perturbation: add Gaussian noise to a random subset of points (maybe all)\n        cand = best_centers.copy()\n        # choose a random subset size\n        # for simplicity, perturb all points\n        cand += rng.normal(scale=sigma, size=cand.shape)\n        # clip to [0,1]\n        cand = np.clip(cand, 0.0, 1.0)\n        # evaluate\n        rad = solve_max_radii(cand)\n        tot = rad.sum()\n        if tot > best_sum:\n            best_sum = tot\n            best_centers = cand.copy()\n            best_radii = rad.copy()\n            # maybe reduce sigma when improvements\n            sigma *= 0.99\n        else:\n            # occasionally accept worse with probability\n            # Simulated annealing:\n            temp = max(0.001, sigma)  # treat sigma as temperature\n            if rng.random()  best_sum:\n        best_sum = tot\n        best_centers = cand\n        best_radii = rad\n        sigma *= 0.99\n    else:\n        # occasionally accept worse\n        if rng.random()"
}